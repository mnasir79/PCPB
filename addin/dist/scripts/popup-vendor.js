"use strict";angular.module("chromeStorage",[]).factory("chromeStorage",function(e){var r=null;try{r=chrome.storage.local}catch(o){console.log("could not initiate chrome local storage: "+o)}var n=null,t={},c=function(o){var n=e.defer();return r.getBytesInUse(o,function(e){chrome.runtime.lasterror?(console.log("error retrieving bytes in use for keys "+o),n.reject(chrome.runtime.lasterror.message)):(console.log("retrieved bytes in use for keys "+o+": "+e),n.resolve(e))}),n.promise};return{getDebuggingTotalBytesInUse:function(){return n},getDebuggingCache:function(){return t},getDebuggingPercentUsed:function(){var e=n/r.QUOTA_BYTES;return e},getDebuggingSizeOf:function(e){return angular.toJson(t[e]).length},updateDebuggingCache:function(){var o=e.defer();r.get(null,function(e){chrome.runtime.lasterror?o.reject(chrome.runtime.lasterror.message):o.resolve(e)}),o.promise.then(function(e){t=e})},updateDebuggingTotalBytes:function(){c(null).then(function(e){console.log("total bytes in use: "+e),n=e})},clearCache:function(){r.clear(function(){chrome.runtime.lastError?console.error("error clearing local cache"+chrome.runtime.lastError):console.log("cache has been cleared")})},drop:function(e){r.remove(e,function(){chrome.runtime.lasterror&&console.error(chrome.runtime.lasterror.message)})},get:function(o){var n=e.defer();return r.get(o,function(e){var r=e[o];n.resolve(r)}),n.promise},getOrElse:function(o,n){var t=e.defer();return r.get(o,function(e){var c=e[o];void 0==c||null==c?n().then(function(e){c=e;var n={};n[o]=c,r.set(n,function(){chrome.runtime.lasterror&&console.error(chrome.runtime.lasterror.message)}),t.resolve(c)}):t.resolve(c)}),t.promise},set:function(e,o){var n={};n[e]=o,r.set(n,function(){chrome.runtime.lasterror&&console.error(chrome.runtime.lasterror.message)})},forceGet:function(o,n){var t=e.defer();return n().then(function(e){keyValue=e;var n={};n[o]=keyValue,r.set(n,function(){chrome.runtime.lasterror&&console.error(chrome.runtime.lasterror.message)}),t.resolve(keyValue)}),t.promise},getQuota:function(){return r.QUOTA_BYTES}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvcG9wdXAtdmVuZG9yLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJmYWN0b3J5IiwiJHEiLCJhcmVhIiwiY2hyb21lIiwic3RvcmFnZSIsImxvY2FsIiwiZXJyIiwiY29uc29sZSIsImxvZyIsInRvdGFsQnl0ZXMiLCJjYWNoZSIsImdldEJ5dGVzSW5Vc2UiLCJrZXlzIiwiZGVmZXJyZWQiLCJkZWZlciIsImJ5dGVzSW5Vc2UiLCJydW50aW1lIiwibGFzdGVycm9yIiwicmVqZWN0IiwibWVzc2FnZSIsInJlc29sdmUiLCJwcm9taXNlIiwiZ2V0RGVidWdnaW5nVG90YWxCeXRlc0luVXNlIiwiZ2V0RGVidWdnaW5nQ2FjaGUiLCJnZXREZWJ1Z2dpbmdQZXJjZW50VXNlZCIsInBlcmNlbnQiLCJRVU9UQV9CWVRFUyIsImdldERlYnVnZ2luZ1NpemVPZiIsImtleSIsInRvSnNvbiIsImxlbmd0aCIsInVwZGF0ZURlYnVnZ2luZ0NhY2hlIiwiZ2V0IiwidmFsdWUiLCJ0aGVuIiwiZGF0YSIsInVwZGF0ZURlYnVnZ2luZ1RvdGFsQnl0ZXMiLCJjbGVhckNhY2hlIiwiY2xlYXIiLCJsYXN0RXJyb3IiLCJlcnJvciIsImRyb3AiLCJyZW1vdmUiLCJrZXlWYWx1ZSIsImdldE9yRWxzZSIsImZhbGxiYWNrIiwidW5kZWZpbmVkIiwic2F2ZU9iamVjdCIsInNldCIsImZvcmNlR2V0IiwiZ2V0UXVvdGEiXSwibWFwcGluZ3MiOiJBQUFBLFlBRUFBLFNBQVFDLE9BQU8sb0JBQ2JDLFFBQVEsZ0JBQWlCLFNBQVNDLEdBQ25DLEdBQUlDLEdBQU8sSUFDWCxLQUNDQSxFQUFPQyxPQUFPQyxRQUFRQyxNQUNyQixNQUFPQyxHQUNSQyxRQUFRQyxJQUFJLDRDQUE4Q0YsR0FNM0QsR0FBSUcsR0FBYSxLQUNiQyxLQU1BQyxFQUFnQixTQUFVQyxHQUMxQixHQUFJQyxHQUFXWixFQUFHYSxPQWFsQixPQVhBWixHQUFLUyxjQUFjQyxFQUFNLFNBQVNHLEdBQzFCWixPQUFPYSxRQUFRQyxXQUNsQlYsUUFBUUMsSUFBSSwwQ0FBNENJLEdBQ3JEQyxFQUFTSyxPQUFPZixPQUFPYSxRQUFRQyxVQUFVRSxXQUc1Q1osUUFBUUMsSUFBSSxtQ0FBcUNJLEVBQU8sS0FBT0csR0FDNURGLEVBQVNPLFFBQVFMLE1BSWxCRixFQUFTUSxRQUdsQixRQUNDQyw0QkFBNkIsV0FDNUIsTUFBT2IsSUFFWGMsa0JBQW1CLFdBQ2xCLE1BQU9iLElBS1JjLHdCQUF5QixXQUN4QixHQUFJQyxHQUFVaEIsRUFBYVAsRUFBS3dCLFdBQ2hDLE9BQU9ELElBRVJFLG1CQUFvQixTQUFTQyxHQUM1QixNQUFPOUIsU0FBUStCLE9BQU9uQixFQUFNa0IsSUFBTUUsUUFFbkNDLHFCQUFzQixXQUNyQixHQUFJbEIsR0FBV1osRUFBR2EsT0FDbEJaLEdBQUs4QixJQUFJLEtBQU0sU0FBVUMsR0FDcEI5QixPQUFPYSxRQUFRQyxVQUNUSixFQUFTSyxPQUFPZixPQUFPYSxRQUFRQyxVQUFVRSxTQUd6Q04sRUFBU08sUUFBUWEsS0FHNUJwQixFQUFTUSxRQUFRYSxLQUFNLFNBQVVDLEdBQ2hDekIsRUFBUXlCLEtBR1ZDLDBCQUEyQixXQUMxQnpCLEVBQWMsTUFBTXVCLEtBQUssU0FBU0MsR0FDakM1QixRQUFRQyxJQUFJLHVCQUF5QjJCLEdBQ3JDMUIsRUFBYTBCLEtBR1pFLFdBQVksV0FFZG5DLEVBQUtvQyxNQUFNLFdBQ05uQyxPQUFPYSxRQUFRdUIsVUFDWmhDLFFBQVFpQyxNQUFNLDZCQUErQnJDLE9BQU9hLFFBQVF1QixXQUUvRGhDLFFBQVFDLElBQUksNkJBSWxCaUMsS0FBTSxTQUFTYixHQUNkMUIsRUFBS3dDLE9BQU9kLEVBQUssV0FDWnpCLE9BQU9hLFFBQVFDLFdBQ1RWLFFBQVFpQyxNQUFNckMsT0FBT2EsUUFBUUMsVUFBVUUsWUFNbkRhLElBQUssU0FBU0osR0FDYixHQUFJZixHQUFXWixFQUFHYSxPQU1sQixPQUxBWixHQUFLOEIsSUFBSUosRUFBSyxTQUFVSyxHQUVqQixHQUFJVSxHQUFXVixFQUFNTCxFQUNsQmYsR0FBU08sUUFBUXVCLEtBRXBCOUIsRUFBU1EsU0FNakJ1QixVQUFXLFNBQVNoQixFQUFLaUIsR0FFeEIsR0FBSWhDLEdBQVdaLEVBQUdhLE9Bd0JsQixPQXZCTVosR0FBSzhCLElBQUlKLEVBQUssU0FBU0ssR0FFdEIsR0FBSVUsR0FBV1YsRUFBTUwsRUFDTGtCLFNBQVpILEdBQXFDLE1BQVpBLEVBRTVCRSxJQUFXWCxLQUFLLFNBQVNDLEdBQ3hCUSxFQUFXUixDQUVYLElBQUlZLEtBQ0pBLEdBQVduQixHQUFPZSxFQUNsQnpDLEVBQUs4QyxJQUFJRCxFQUFZLFdBQ2hCNUMsT0FBT2EsUUFBUUMsV0FDZlYsUUFBUWlDLE1BQU1yQyxPQUFPYSxRQUFRQyxVQUFVRSxXQUs1Q04sRUFBU08sUUFBUXVCLEtBR2xCOUIsRUFBU08sUUFBUXVCLEtBR2xCOUIsRUFBU1EsU0FLakIyQixJQUFLLFNBQVNwQixFQUFLSyxHQUNsQixHQUFJYyxLQUNKQSxHQUFXbkIsR0FBT0ssRUFDbEIvQixFQUFLOEMsSUFBSUQsRUFBWSxXQUNoQjVDLE9BQU9hLFFBQVFDLFdBQ2ZWLFFBQVFpQyxNQUFNckMsT0FBT2EsUUFBUUMsVUFBVUUsWUFXN0M4QixTQUFVLFNBQVNyQixFQUFLaUIsR0FFdkIsR0FBSWhDLEdBQVdaLEVBQUdhLE9BZWxCLE9BZE0rQixLQUFXWCxLQUFLLFNBQVNDLEdBQzlCUSxTQUFXUixDQUVYLElBQUlZLEtBQ0pBLEdBQVduQixHQUFPZSxTQUNsQnpDLEVBQUs4QyxJQUFJRCxFQUFZLFdBQ2hCNUMsT0FBT2EsUUFBUUMsV0FDVFYsUUFBUWlDLE1BQU1yQyxPQUFPYSxRQUFRQyxVQUFVRSxXQUtsRE4sRUFBU08sUUFBUXVCLFlBRVg5QixFQUFTUSxTQUtqQjZCLFNBQVUsV0FDVCxNQUFPaEQsR0FBS3dCIiwiZmlsZSI6InNjcmlwdHMvcG9wdXAtdmVuZG9yLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhci5tb2R1bGUoXCJjaHJvbWVTdG9yYWdlXCIsW10pXHJcblx0LmZhY3RvcnkoJ2Nocm9tZVN0b3JhZ2UnLCBmdW5jdGlvbigkcSkge1xyXG5cdHZhciBhcmVhID0gbnVsbDtcclxuXHR0cnkge1xyXG5cdFx0YXJlYSA9IGNocm9tZS5zdG9yYWdlLmxvY2FsOyAvLyBjaGFuZ2UgdGhpcyB0byBjaHJvbWUuc3RvcmFnZS5zeW5jIGZvciBzeW5jIGNhcGFiaWxpdGllc1xyXG5cdH0gY2F0Y2ggKGVycikge1xyXG5cdFx0Y29uc29sZS5sb2coXCJjb3VsZCBub3QgaW5pdGlhdGUgY2hyb21lIGxvY2FsIHN0b3JhZ2U6IFwiICsgZXJyKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRoZXNlIGFyZSBwcm92aWRlZCBhbmQgdXBkYXRlZCBvbmx5IGZvciBkZWJ1Z2dpbmcgcHVycG9zZXMuXHJcblx0ICovXHJcblx0dmFyIHRvdGFsQnl0ZXMgPSBudWxsO1xyXG5cdHZhciBjYWNoZSA9IHt9O1xyXG5cclxuXHQvKipcclxuXHQgKiBBIGNhbGwgdG8gZ2V0IHRoZSBieXRlcyBpbiB1c2UsIHJldHVybnMgYSBwcm9taXNlIG9mIHRoZSBzaXplIG9mIGFuIGluZGl2aWR1YWwga2V5LCBvclxyXG5cdCAqIG9mIHRvdGFsIGJ5dGVzIGluIHVzZSwgaWYgbm8ga2V5IGlzIHNwZWNpZmllZC5cclxuXHQgKi9cclxuXHR2YXIgZ2V0Qnl0ZXNJblVzZSA9IGZ1bmN0aW9uIChrZXlzKXtcclxuXHQgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHJcblx0ICAgIGFyZWEuZ2V0Qnl0ZXNJblVzZShrZXlzLCBmdW5jdGlvbihieXRlc0luVXNlKSB7XHJcblx0ICAgICAgICBpZiAoY2hyb21lLnJ1bnRpbWUubGFzdGVycm9yKXtcclxuXHQgICAgICAgIFx0Y29uc29sZS5sb2coXCJlcnJvciByZXRyaWV2aW5nIGJ5dGVzIGluIHVzZSBmb3Iga2V5cyBcIiArIGtleXMpO1xyXG5cdCAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChjaHJvbWUucnVudGltZS5sYXN0ZXJyb3IubWVzc2FnZSk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgIFx0Y29uc29sZS5sb2coXCJyZXRyaWV2ZWQgYnl0ZXMgaW4gdXNlIGZvciBrZXlzIFwiICsga2V5cyArIFwiOiBcIiArIGJ5dGVzSW5Vc2UpO1xyXG5cdCAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoYnl0ZXNJblVzZSk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH0pO1xyXG5cclxuXHQgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0fVxyXG5cclxuICAgcmV0dXJuIHtcclxuICAgXHRnZXREZWJ1Z2dpbmdUb3RhbEJ5dGVzSW5Vc2U6IGZ1bmN0aW9uKCkge1xyXG4gICBcdFx0cmV0dXJuIHRvdGFsQnl0ZXM7XHJcbiAgIFx0fSxcclxuXHRnZXREZWJ1Z2dpbmdDYWNoZTogZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gY2FjaGU7XHJcblx0fSxcclxuXHQvKipcclxuXHQgKiBSZXR1cm5zIHRoZSB1c2FnZSBvZiB0aGUgY3VycmVudCBzdG9yYWdlIHF1b3RhLCBhcyBhIG51bWJlciBiZXR3ZWVuIDAuMCBhbmQgMS4wXHJcblx0ICovXHJcblx0Z2V0RGVidWdnaW5nUGVyY2VudFVzZWQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHBlcmNlbnQgPSB0b3RhbEJ5dGVzIC8gYXJlYS5RVU9UQV9CWVRFUztcclxuXHRcdHJldHVybiBwZXJjZW50O1xyXG5cdH0sXHJcblx0Z2V0RGVidWdnaW5nU2l6ZU9mOiBmdW5jdGlvbihrZXkpIHtcclxuXHRcdHJldHVybiBhbmd1bGFyLnRvSnNvbihjYWNoZVtrZXldKS5sZW5ndGg7XHJcblx0fSxcclxuXHR1cGRhdGVEZWJ1Z2dpbmdDYWNoZTogZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG5cdFx0YXJlYS5nZXQobnVsbCwgZnVuY3Rpb24gKHZhbHVlKSB7XHJcblx0XHRcdGlmIChjaHJvbWUucnVudGltZS5sYXN0ZXJyb3Ipe1xyXG5cdCAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChjaHJvbWUucnVudGltZS5sYXN0ZXJyb3IubWVzc2FnZSk7XHJcblx0ICAgICAgICB9IGVsc2Uge1xyXG5cdCAgICAgICAgICAvL2NvbnNvbGUubG9nKCdnZXQgdGhlbiBmb3IgYWxsIGtleXMgOiAnICsgYW5ndWxhci50b0pzb24odmFsdWUpKTtcclxuICBcdCAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHZhbHVlKTtcclxuICBcdCAgICAgICAgfVxyXG5cdFx0fSk7XHJcblx0XHRkZWZlcnJlZC5wcm9taXNlLnRoZW4gKGZ1bmN0aW9uIChkYXRhKSB7XHJcblx0XHRcdGNhY2hlID0gZGF0YTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0dXBkYXRlRGVidWdnaW5nVG90YWxCeXRlczogZnVuY3Rpb24oKSB7XHJcblx0XHRnZXRCeXRlc0luVXNlKG51bGwpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcInRvdGFsIGJ5dGVzIGluIHVzZTogXCIgKyBkYXRhKTtcclxuXHRcdFx0dG90YWxCeXRlcyA9IGRhdGE7XHJcblx0XHR9KTtcclxuXHR9LFxyXG4gICAgY2xlYXJDYWNoZTogZnVuY3Rpb24oKSB7XHJcblx0XHQvLyBjb25zb2xlLmxvZygnY2xlYXJpbmcgbG9jYWwgY2FjaGUnKTtcclxuXHRcdGFyZWEuY2xlYXIoZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmIChjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpIHtcclxuXHRcdCAgICAgICAgY29uc29sZS5lcnJvcihcImVycm9yIGNsZWFyaW5nIGxvY2FsIGNhY2hlXCIgKyBjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpO1xyXG5cdFx0ICAgIH0gZWxzZSB7XHJcblx0ICAgIFx0XHRjb25zb2xlLmxvZyhcImNhY2hlIGhhcyBiZWVuIGNsZWFyZWRcIik7XHJcblx0ICAgIFx0fVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRkcm9wOiBmdW5jdGlvbihrZXkpIHtcclxuXHRcdGFyZWEucmVtb3ZlKGtleSwgZnVuY3Rpb24oKXtcclxuXHRcdFx0aWYgKGNocm9tZS5ydW50aW1lLmxhc3RlcnJvcil7XHJcblx0ICAgICAgICAgICAgY29uc29sZS5lcnJvcihjaHJvbWUucnVudGltZS5sYXN0ZXJyb3IubWVzc2FnZSk7XHJcblx0ICAgICAgICB9IGVsc2Uge1xyXG5cdCAgICAgICAgXHQvLyBjb25zb2xlLmxvZyhcImtleSBcIiArIGtleSArIFwiIGhhcyBiZWVuIGRyb3BwZWQgZnJvbSB0aGUgc3RvcmFnZSBjYWNoZVwiKVxyXG5cdCAgICAgICAgfVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRnZXQ6IGZ1bmN0aW9uKGtleSkge1xyXG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHRcdGFyZWEuZ2V0KGtleSwgZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgXHQvLyBjb25zb2xlLmxvZygnZ2V0VG90YWxCeXRlc0luVXNlIHRoZW4gd2l0aCBrZXkgJyArIGtleSArIFwiIDogXCIgKyBhbmd1bGFyLnRvSnNvbih2YWx1ZSkpO1xyXG4gICAgICAgIFx0dmFyIGtleVZhbHVlID0gdmFsdWVba2V5XTtcclxuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShrZXlWYWx1ZSk7XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cdH0sXHJcblx0LyoqXHJcblx0ICogZ2V0cyB0aGUgdmFsdWUgb2Yga2V5IGZyb20gdGhlIGNhY2hlLCBvciBjYWxscyB0aGUgZmFsbGJhY2sgZnVuY3Rpb24sIGFuZCBwb3B1bGF0ZXMgdGhlIGNhY2hlXHJcblx0ICogd2l0aCB0aGUgdmFsdWUgb2YgdGhlIHByb21pc2UgcmV0dXJuZWRcclxuXHQgKi9cclxuXHRnZXRPckVsc2U6IGZ1bmN0aW9uKGtleSwgZmFsbGJhY2spIHtcclxuXHRcdC8vIGNvbnNvbGUubG9nKCdnZXRPckVsc2UgY2FsbGVkIHdpdGggIGNhY2hlZCBrZXkgJyArIGtleSk7XHJcblx0XHR2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgIGFyZWEuZ2V0KGtleSwgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICBcdC8vIGNvbnNvbGUubG9nKCdnZXRPckVsc2UgdGhlbiB3aXRoIGNhY2hlZCBrZXkgJyArIGtleSArIFwiIDogXCIgKyBhbmd1bGFyLnRvSnNvbih2YWx1ZSkpO1xyXG4gICAgICAgIFx0dmFyIGtleVZhbHVlID0gdmFsdWVba2V5XTtcclxuICAgICAgICBcdGlmIChrZXlWYWx1ZSA9PSB1bmRlZmluZWQgfHwga2V5VmFsdWUgPT0gbnVsbCkge1xyXG4gICAgICAgIFx0XHQvLyBjb25zb2xlLmxvZyhcIm5vIGNhY2hlZCB2YWx1ZSBmb3IgXCIrIGtleSArIFwiLiB1c2luZyBmYWxsYmFjayBtZXRob2QuXCIpO1xyXG4gICAgICAgIFx0XHRmYWxsYmFjaygpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgIFx0XHRcdGtleVZhbHVlID0gZGF0YTtcclxuICAgICAgICBcdFx0XHQvLyBjb25zb2xlLmxvZyhcImNhY2hpbmcgdmFsdWUgZm9yIFwiKyBrZXkgKyBcIiA6IFwiICsgYW5ndWxhci50b0pzb24oa2V5VmFsdWUpKTtcclxuICAgICAgICBcdFx0XHR2YXIgc2F2ZU9iamVjdCA9IHt9O1xyXG4gICAgICAgIFx0XHRcdHNhdmVPYmplY3Rba2V5XSA9IGtleVZhbHVlO1xyXG4gICAgICAgIFx0XHRcdGFyZWEuc2V0KHNhdmVPYmplY3QsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIFx0XHRcdFx0aWYgKGNocm9tZS5ydW50aW1lLmxhc3RlcnJvcil7XHJcblx0XHRcdFx0ICAgICAgICAgICAgY29uc29sZS5lcnJvcihjaHJvbWUucnVudGltZS5sYXN0ZXJyb3IubWVzc2FnZSk7XHJcblx0XHRcdFx0ICAgICAgICB9IGVsc2Uge1xyXG5cdFx0ICAgIFx0XHRcdFx0Ly9jb25zb2xlLmxvZygnc2F2ZWQgJyArIGtleVZhbHVlICsgXCIgdG8ga2V5IFwiICsga2V5KTtcclxuXHRcdCAgICBcdFx0XHR9XHJcbiAgICAgICAgXHRcdFx0fSk7XHJcbiAgICAgICAgXHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShrZXlWYWx1ZSk7XHJcbiAgICAgICAgXHRcdH0pO1xyXG4gICAgICAgIFx0fSBlbHNlIHtcclxuXHQgICAgICAgIFx0ZGVmZXJyZWQucmVzb2x2ZShrZXlWYWx1ZSk7XHJcblx0ICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHR9LFxyXG5cdC8qKlxyXG5cdCpcclxuXHQqL1xyXG5cdHNldDogZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xyXG5cdFx0dmFyIHNhdmVPYmplY3QgPSB7fTtcclxuXHRcdHNhdmVPYmplY3Rba2V5XSA9IHZhbHVlO1xyXG5cdFx0YXJlYS5zZXQoc2F2ZU9iamVjdCwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmIChjaHJvbWUucnVudGltZS5sYXN0ZXJyb3Ipe1xyXG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoY2hyb21lLnJ1bnRpbWUubGFzdGVycm9yLm1lc3NhZ2UpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKCdzYXZlZCAnICsga2V5VmFsdWUgKyBcIiB0byBrZXkgXCIgKyBrZXkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH0sXHJcblxyXG5cdC8qKlxyXG5cdCAqIGdldHMgdGhlIHZhbHVlIG9mIGtleSBmcm9tIHRoZSBjYWNoZSwgb3IgY2FsbHMgdGhlIGZhbGxiYWNrIGZ1bmN0aW9uLCBhbmQgcG9wdWxhdGVzIHRoZSBjYWNoZVxyXG5cdCAqIHdpdGggdGhlIHZhbHVlIG9mIHRoZSBwcm9taXNlIHJldHVybmVkXHJcblx0ICovXHJcblx0Zm9yY2VHZXQ6IGZ1bmN0aW9uKGtleSwgZmFsbGJhY2spIHtcclxuXHRcdC8vIGNvbnNvbGUubG9nKCdnZXRPckVsc2UgY2FsbGVkIHdpdGggIGNhY2hlZCBrZXkgJyArIGtleSk7XHJcblx0XHR2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgIGZhbGxiYWNrKCkudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRcdGtleVZhbHVlID0gZGF0YTtcclxuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJjYWNoaW5nIHZhbHVlIGZvciBcIisga2V5ICsgXCIgOiBcIiArIGFuZ3VsYXIudG9Kc29uKGtleVZhbHVlKSk7XHJcblx0XHRcdHZhciBzYXZlT2JqZWN0ID0ge307XHJcblx0XHRcdHNhdmVPYmplY3Rba2V5XSA9IGtleVZhbHVlO1xyXG5cdFx0XHRhcmVhLnNldChzYXZlT2JqZWN0LCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZiAoY2hyb21lLnJ1bnRpbWUubGFzdGVycm9yKXtcclxuXHRcdCAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoY2hyb21lLnJ1bnRpbWUubGFzdGVycm9yLm1lc3NhZ2UpO1xyXG5cdFx0ICAgICAgICB9IGVsc2Uge1xyXG4gICAgXHRcdFx0XHQvL2NvbnNvbGUubG9nKCdzYXZlZCAnICsga2V5VmFsdWUgKyBcIiB0byBrZXkgXCIgKyBrZXkpO1xyXG4gICAgXHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShrZXlWYWx1ZSk7XHJcblx0XHR9KTtcclxuXHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cdH0sXHJcblx0LyoqXHJcblx0ICogUmV0dXJucyB0aGUgcXVvdGEgb2YgdGhlIGN1cnJlbnQgc3RvcmFnZSBtZXRob2QsIGluIGJ5dGVzXHJcblx0ICovXHJcblx0Z2V0UXVvdGE6IGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIGFyZWEuUVVPVEFfQllURVM7XHJcblx0fVxyXG5cclxuICAgfVxyXG59KTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
